inner_join(us_fdi_for_join, by = c("country_name" = "economy_label", "year" = "year"))
world_trade_final <- na.omit(world_trade_final)
world_trade_final <- world_trade_final %>%
filter(country_name != "World")
world_trade_final <- world_trade_final %>%
mutate(ln_gdp = log(gdp), ln_gdp_per_cap_current = log(gdppercapcurrentusd), ln_gdp_per_cap2010 = log(gdppercap2010usd))
world_trade_final <- world_trade_final %>%
mutate(gdppercapcurrentusd_sq = gdppercapcurrentusd^2, gdppercap2010usd = gdppercap2010usd^2)
world_trade_final <- world_trade_final %>%
select(-c(17:18))
world_trade_final <- world_trade_final %>%
rename(value_of_inbound_fdi_mil_usd = us_dollars_at_current_prices_in_millions) %>%
rename(value_of_inbound_fdi_usd_per_cap = us_dollars_at_current_prices_per_capita)
view(world_trade_final)
# PART 4: Fitting a Model
prelim_model <- lm(value_of_inbound_fdi_mil_usd ~ gdp + gdppercapcurrentusd + ln_gdp + ln_gdp_per_cap_current + gdppercapcurrentusd_sq + is_2018 + is_2019, data = world_trade_final)
summary(prelim_model)
resids <- add_residuals(world_trade_final, prelim_model, var = "resid") %>%
filter(!is.na(resid)) %>%
filter(country_name == "China") %>%
select(country_name, resid) %>%
arrange(desc(resid))
view(resids)
resids <- add_residuals(world_trade_final, prelim_model, var = "resid") %>%
filter(!is.na(resid)) %>%
filter(country_name %in% c("China" "United States")) %>%
select(country_name, resid) %>%
arrange(desc(resid))
resids <- add_residuals(world_trade_final, prelim_model, var = "resid") %>%
filter(!is.na(resid)) %>%
filter(country_name %in% c("China", "United States")) %>%
select(country_name, resid) %>%
arrange(desc(resid))
view(resids)
styler:::style_selection()
View(world_trade_final)
resids <- add_residuals(world_trade_final, prelim_model, var = "resid") %>%
filter(!is.na(resid)) %>%
select(country_name, resid) %>%
arrange(desc(resid))
View(resids)
unique(world_trade_final$country_name)
world_trade_final <- world_trade_final %>%
filter(country_name != "Euro area" & country_name != "Sub-Saharan Africa")
unique(world_trade_final$country_name)
library(spData)
library(scales)
data("countryExData")
View(countryExData)
View(world_trade_final)
world_trade_mapping <- countryExData %>%
inner_join(world_trade_final, by = c("Country" = "country_name"))
view(count)
view(world_trade_mapping)
world_trade_shape <- joinCountryData2Map(world_trade_mapping,
joinCode = "ISO3",
nameJoinColumn = "ISO3V10")
View(world_trade_shape)
mapCountryData(world_trade_shape,
nameColumnToPlot = gdp)
mapCountryData(world_trade_shape,
nameColumnToPlot = 'gdp')
?geom_sf
ggplot() +
geom_sf(data = world)
view(world)
world_trade_mapping <- world %>%
inner_join(world_trade_final, by = c("name_long" = "country_name"))
view(world_trade_mapping)
world_trade_mapping_17 <- world %>%
inner_join(world_trade_final, by = c("name_long" = "country_name")) %>%
filter(year == "2017")
View(world_trade_mapping_17)
create_sf <- function(year) {
sfile <- world %>%
inner_join(world_trade_final, by = c("name_long" = "country_name")) %>%
filter(year == year)
}
create_sf <- function(year) {
sfile <- world %>%
inner_join(world_trade_final, by = c("name_long" = "country_name")) %>%
filter(year == year)
return(sfile)
}
create_sf(2018)
world_trade_mapping_18 <- world %>%
inner_join(world_trade_final, by = c("name_long" = "country_name")) %>%
filter(year == "2018")
world_trade_mapping_19 <- world %>%
inner_join(world_trade_final, by = c("name_long" = "country_name")) %>%
filter(year == "2019")
ggplot() +
geom_sf(data = world_trade_mapping_17, color = "red", aes(size = gdp))
ggplot() +
geom_sf(data = world_trade_mapping_17, color = "red", aes(fill = gdp))
ggplot() +
geom_sf(data = world_trade_mapping_17, aes(fill = gdp))
ggplot() +
geom_sf(data = world_trade_mapping_17, aes(fill = value_of_inbound_fdi_mil_usd))
?scale_fill_viridis_c
ggplot() +
geom_sf(data = world_trade_mapping_17, aes(fill = value_of_inbound_fdi_mil_usd)) +
scale_fill_viridis_c(option = "magma")
world_trade_mapping_17 <- world %>%
left_join(world_trade_final, by = c("name_long" = "country_name")) %>%
filter(year == "2017")
ggplot() +
geom_sf(data = world_trade_mapping_17, aes(fill = value_of_inbound_fdi_mil_usd)) +
scale_fill_viridis_c(option = "magma")
world_trade_mapping_17 <- world %>%
inner_join(world_trade_final, by = c("name_long" = "country_name")) %>%
filter(year == "2017")
View(gdp_part)
gdp_part <- gdp_data_tidy %>% pivot_longer(
cols = starts_with(c("2017", "2018", "2019")),
names_to = c("year"),
values_to = c("value"),
values_drop_na = TRUE
)
gdp_part$value <- as.numeric(gdp_part$value)
gdp_part <- gdp_part %>%
separate(
col = year,
into = c("year", "measure"),
sep = "_"
) %>%
filter(!is.na(value))
gdp_part <- gdp_part %>%
group_by(country_name, year, measure) %>%
summarise(value = sum(value))
gdp_part <- gdp_part %>%
pivot_wider(names_from = measure, values_from = value)
gdp_part[is.na(gdp_part)] = 0
gdp_final <- gdp_part[is.na(gdp_part)] = 0
gdp_final <- gdp_part
world_trade_final <- gdp_final %>%
inner_join(world_ex_im_tidy, by = c("country_name" = "country_name", "year" = "year"))
world_trade_final <- world_trade_final %>%
mutate(trade_openness = ((exports_of_goods_and_services_current_us + imports_of_goods_and_services_bo_p_current_us) / gdp))
world_trade_final <- world_trade_final %>%
mutate(is_2017 = ifelse(year == 2017, 1, 0)) %>%
mutate(is_2018 = ifelse(year == 2018, 1, 0)) %>%
mutate(is_2019 = ifelse(year == 2019, 1, 0))
us_fdi$year <- as.character(us_fdi$year)
us_fdi <- us_fdi %>%
filter(direction_label == "Inward", mode_label == "Flow", year %in% c("2017", "2018", "2019"))
us_fdi_for_join <- us_fdi %>% # Eliminating unnecessary columns
select(1, 3, 8:11)
us_fdi_for_join$economy_label[us_fdi_for_join$economy_label == "United States of America"] <- "United States"
world_trade_final <- world_trade_final %>%
inner_join(us_fdi_for_join, by = c("country_name" = "economy_label", "year" = "year"))
world_trade_final <- na.omit(world_trade_final)
world_trade_final <- world_trade_final %>%
filter(country_name != "World")
world_trade_final <- world_trade_final %>%
mutate(ln_gdp = log(gdp), ln_gdp_per_cap_current = log(gdppercapcurrentusd), ln_gdp_per_cap2010 = log(gdppercap2010usd))
world_trade_final <- world_trade_final %>%
mutate(gdppercapcurrentusd_sq = gdppercapcurrentusd^2, gdppercap2010usd = gdppercap2010usd^2)
world_trade_final <- world_trade_final %>%
select(-c(17:18))
world_trade_final <- world_trade_final %>%
rename(value_of_inbound_fdi_mil_usd = us_dollars_at_current_prices_in_millions) %>%
rename(value_of_inbound_fdi_usd_per_cap = us_dollars_at_current_prices_per_capita)
world_trade_final <- world_trade_final %>%
filter(country_name != "Euro area" & country_name != "Sub-Saharan Africa")
View(world_ex_im_tidy)
world_ex_im_tidy <- world_ex_im %>%
pivot_longer(
cols = starts_with(c("2017", "2018", "2019")),
names_to = c("year"),
values_to = c("value"),
values_drop_na = TRUE
)
world_ex_im_tidy <- world_ex_im_tidy %>%
select(-`Series Code`)
world_ex_im_tidy <- clean_names(world_ex_im_tidy)
world_ex_im_tidy <- world_ex_im_tidy %>%
pivot_wider(names_from = series_name, values_from = value)
world_ex_im_tidy$year <- str_extract(world_ex_im_tidy$year, "20..")
world_ex_im_tidy$exports_of_goods_and_services_current_us <- as.numeric(world_ex_im_tidy$exports_of_goods_and_services_current_us)
world_ex_im_tidy$imports_of_goods_and_services_bo_p_current_us <- as.numeric(world_ex_im_tidy$imports_of_goods_and_services_bo_p_current_us)
world_ex_im_tidy$exports_of_goods_and_services_current_us <- as.numeric(world_ex_im_tidy$exports_of_goods_and_services_current_us)
world_ex_im_tidy <- clean_names(world_ex_im_tidy)
world_ex_im_tidy$exports_of_goods_and_services_current_us <- as.numeric(world_ex_im_tidy$exports_of_goods_and_services_current_us)
world_ex_im_tidy$imports_of_goods_and_services_bo_p_current_us <- as.numeric(world_ex_im_tidy$imports_of_goods_and_services_bo_p_current_us)
world_ex_im_tidy[is.na(world_ex_im_tidy)] = 0
world_trade_final <- gdp_final %>%
inner_join(world_ex_im_tidy, by = c("country_name" = "country_name", "year" = "year"))
View(world_trade_final)
world_trade_final <- world_trade_final %>%
mutate(trade_openness = ((exports_of_goods_and_services_current_us + imports_of_goods_and_services_bo_p_current_us) / gdp))
world_trade_final <- world_trade_final %>%
mutate(is_2017 = ifelse(year == 2017, 1, 0)) %>%
mutate(is_2018 = ifelse(year == 2018, 1, 0)) %>%
mutate(is_2019 = ifelse(year == 2019, 1, 0))
us_fdi$year <- as.character(us_fdi$year)
us_fdi <- us_fdi %>%
filter(direction_label == "Inward", mode_label == "Flow", year %in% c("2017", "2018", "2019"))
us_fdi_for_join <- us_fdi %>% # Eliminating unnecessary columns
select(1, 3, 8:11)
us_fdi_for_join$economy_label[us_fdi_for_join$economy_label == "United States of America"] <- "United States"
world_trade_final <- world_trade_final %>%
inner_join(us_fdi_for_join, by = c("country_name" = "economy_label", "year" = "year"))
world_trade_final <- world_trade_final %>%
filter(country_name != "World")
world_trade_final <- world_trade_final %>%
mutate(ln_gdp = log(gdp), ln_gdp_per_cap_current = log(gdppercapcurrentusd), ln_gdp_per_cap2010 = log(gdppercap2010usd))
world_trade_final <- world_trade_final %>%
mutate(gdppercapcurrentusd_sq = gdppercapcurrentusd^2, gdppercap2010usd = gdppercap2010usd^2)
world_trade_final <- world_trade_final %>%
select(-c(17:18))
world_trade_final <- world_trade_final %>%
rename(value_of_inbound_fdi_mil_usd = us_dollars_at_current_prices_in_millions) %>%
rename(value_of_inbound_fdi_usd_per_cap = us_dollars_at_current_prices_per_capita)
world_trade_final <- world_trade_final %>%
filter(country_name != "Euro area" & country_name != "Sub-Saharan Africa")
View(world_trade_final)
world_trade_mapping_17 <- world %>%
inner_join(world_trade_final, by = c("name_long" = "country_name")) %>%
filter(year == "2017")
ggplot() +
geom_sf(data = world_trade_mapping_17, aes(fill = value_of_inbound_fdi_mil_usd)) +
scale_fill_viridis_c(option = "magma")
world_trade_mapping_17 <- world %>%
inner_join(world_trade_final, by = c("name_long" = "country_name")) %>%
filter(year == "2017")
unique(world$name_long)
unique(world_trade_mapping_17)
unique(world_trade_final$country_name)
head(world_ex_im)
unique(world_ex_im$`Country Name`)
install.packages("countrycode")
library(countrycode)
?codelist
install.packages("StandardizeText")
library(StandardizeText)
?standardize.countrynames
view(gdp_data_tidy$country_name)
gdp_data_tidy$country_name <- standardize.countrynames(gdp_data_tidy$country_name, standard = "iso", suggest = "auto")
View(us_fdi)
us_fdi$economy_label <- standardize.countrynames(us_fdi$economy_label, standard = "iso", suggest = "auto")
View(total_trade_flows)
View(world_ex_im_tidy)
world_ex_im_tidy$country_name <- standardize.countrynames(world_ex_im_tidy$country_name, standard = "iso", suggest = "auto")
world_ex_im_tidy <- world_ex_im_tidy %>%
pivot_wider(names_from = series_name, values_from = value)
world_ex_im_tidy <- world_ex_im %>%
pivot_longer(
cols = starts_with(c("2017", "2018", "2019")),
names_to = c("year"),
values_to = c("value"),
values_drop_na = TRUE
)
world_ex_im_tidy <- world_ex_im_tidy %>%
select(-`Series Code`)
world_ex_im_tidy <- clean_names(world_ex_im_tidy)
world_ex_im_tidy$country_name <- standardize.countrynames(world_ex_im_tidy$country_name, standard = "iso", suggest = "auto")
world_ex_im_tidy <- world_ex_im_tidy %>%
pivot_wider(names_from = series_name, values_from = value)
world_ex_im_tidy$year <- str_extract(world_ex_im_tidy$year, "20..")
world_ex_im_tidy$exports_of_goods_and_services_current_us <- as.numeric(world_ex_im_tidy$exports_of_goods_and_services_current_us)
world_ex_im_tidy <- world_ex_im %>%
pivot_longer(
cols = starts_with(c("2017", "2018", "2019")),
names_to = c("year"),
values_to = c("value"),
values_drop_na = TRUE
)
world_ex_im_tidy <- world_ex_im_tidy %>%
select(-`Series Code`)
world_ex_im_tidy <- clean_names(world_ex_im_tidy)
world_ex_im_tidy$country_name <- standardize.countrynames(world_ex_im_tidy$country_name, standard = "iso", suggest = "auto")
world_ex_im_tidy <- world_ex_im_tidy %>%
pivot_wider(names_from = series_name, values_from = value)
world_ex_im_tidy$year <- str_extract(world_ex_im_tidy$year, "20..")
world_ex_im_tidy$exports_of_goods_and_services_current_us <- as.numeric(world_ex_im_tidy$exports_of_goods_and_services_current_us)
world_ex_im_tidy <- clean_names(world_ex_im_tidy)
world_ex_im_tidy$country_name <- standardize.countrynames(world_ex_im_tidy$country_name, standard = "iso", suggest = "auto")
world_ex_im_tidy <- world_ex_im_tidy %>%
pivot_wider(names_from = series_name, values_from = value)
world_ex_im_tidy$year <- str_extract(world_ex_im_tidy$year, "20..")
world_ex_im_tidy$exports_of_goods_and_services_current_us <- as.numeric(world_ex_im_tidy$exports_of_goods_and_services_current_us)
world_ex_im_tidy$imports_of_goods_and_services_bo_p_current_us <- as.numeric(world_ex_im_tidy$imports_of_goods_and_services_bo_p_current_us)
#world_ex_im_tidy <- na.omit(world_ex_im_tidy) # Omitting NAs, because it is unclear what to impute for them
world_ex_im_tidy[is.na(world_ex_im_tidy)] = 0
world_trade_final <- gdp_final %>%
inner_join(world_ex_im_tidy, by = c("country_name" = "country_name", "year" = "year"))
world_trade_final <- world_trade_final %>%
mutate(trade_openness = ((exports_of_goods_and_services_current_us + imports_of_goods_and_services_bo_p_current_us) / gdp))
world_trade_final <- world_trade_final %>%
mutate(is_2017 = ifelse(year == 2017, 1, 0)) %>%
mutate(is_2018 = ifelse(year == 2018, 1, 0)) %>%
mutate(is_2019 = ifelse(year == 2019, 1, 0))
us_fdi$year <- as.character(us_fdi$year)
us_fdi <- us_fdi %>%
filter(direction_label == "Inward", mode_label == "Flow", year %in% c("2017", "2018", "2019"))
us_fdi_for_join <- us_fdi %>% # Eliminating unnecessary columns
select(1, 3, 8:11)
us_fdi_for_join$economy_label[us_fdi_for_join$economy_label == "United States of America"] <- "United States"
world_trade_final <- world_trade_final %>%
inner_join(us_fdi_for_join, by = c("country_name" = "economy_label", "year" = "year"))
world_trade_final <- world_trade_final %>%
filter(country_name != "World")
world_trade_final <- world_trade_final %>%
mutate(ln_gdp = log(gdp), ln_gdp_per_cap_current = log(gdppercapcurrentusd), ln_gdp_per_cap2010 = log(gdppercap2010usd))
world_trade_final <- world_trade_final %>%
mutate(gdppercapcurrentusd_sq = gdppercapcurrentusd^2, gdppercap2010usd = gdppercap2010usd^2)
world_trade_final <- world_trade_final %>%
select(-c(17:18))
world_trade_final <- world_trade_final %>%
rename(value_of_inbound_fdi_mil_usd = us_dollars_at_current_prices_in_millions) %>%
rename(value_of_inbound_fdi_usd_per_cap = us_dollars_at_current_prices_per_capita)
world_trade_final <- world_trade_final %>%
filter(country_name != "Euro area" & country_name != "Sub-Saharan Africa")
world_trade_mapping_17 <- world %>%
inner_join(world_trade_final, by = c("name_long" = "country_name")) %>%
filter(year == "2017")
ggplot() +
geom_sf(data = world_trade_mapping_17, aes(fill = value_of_inbound_fdi_mil_usd)) +
scale_fill_viridis_c(option = "magma")
ggplot() +
geom_sf(data = world_trade_mapping_17, aes(fill = value_of_inbound_fdi_mil_usd)) +
scale_fill_viridis_c(option = "magma")
world_trade_mapping_17 <- world %>%
inner_join(world_trade_final, by = c("name_long" = "country_name")) %>%
filter(year == "2017")
world_trade_mapping_18 <- world %>%
inner_join(world_trade_final, by = c("name_long" = "country_name")) %>%
filter(year == "2018")
world_trade_mapping_19 <- world %>%
inner_join(world_trade_final, by = c("name_long" = "country_name")) %>%
filter(year == "2019")
View(world_trade_final)
world2 <- world
world2$name_long <- standardize.countrynames(world_ex_im_tidy$country_name, standard = "iso", suggest = "auto")
world2$name_long <- standardize.countrynames(world2$country_name, standard = "iso", suggest = "auto")
world2$name_long <- standardize.countrynames(world2$name_long, standard = "iso", suggest = "auto")
View(world2)
world2 <- world
View(world2)
world2$name_long <- standardize.countrynames(world2$name_long, standard = "iso", suggest = "auto")
world_trade_mapping_17 <- world %>%
inner_join(world_trade_final, by = c("name_long" = "country_name")) %>%
filter(year == "2017")
world_trade_mapping_17 <- world2 %>%
inner_join(world_trade_final, by = c("name_long" = "country_name")) %>%
filter(year == "2017")
ggplot() +
geom_sf(data = world_trade_mapping_17, aes(fill = value_of_inbound_fdi_mil_usd)) +
scale_fill_viridis_c(option = "magma")
world_trade_mapping_17 <- world2 %>%
inner_join(world_trade_final, by = c("name_long" = "country_name")) %>%
filter(year == "2017")
world_trade_mapping_17 <- world2 %>%
left_join(world_trade_final, by = c("name_long" = "country_name")) %>%
filter(year == "2017")
ggplot() +
geom_sf(data = world_trade_mapping_17, aes(fill = value_of_inbound_fdi_mil_usd)) +
scale_fill_viridis_c(option = "magma")
world_trade_final %>%
filter(year == 2017)
world_trade_final %>%
filter(year == 2017)
view(world_trade_final %>%
filter(year == 2017))
view(world2) %>%
filter(name_long == iran)
view(world2) %>%
filter(name_long == Iran)
view(world)
view(world) %>%
filter(continent == Asia)
unique(world$name_long)
View(world_ex_im_tidy)
View(gdp_final)
gdp_final$country_name <- standardize.countrynames(gdp_final$country_name, standard = "iso", suggest = "auto")
world_trade_final <- gdp_final %>%
inner_join(world_ex_im_tidy, by = c("country_name" = "country_name", "year" = "year"))
View(world_trade_final)
world_trade_final <- world_trade_final %>%
mutate(trade_openness = ((exports_of_goods_and_services_current_us + imports_of_goods_and_services_bo_p_current_us) / gdp))
world_trade_final <- world_trade_final %>%
mutate(is_2017 = ifelse(year == 2017, 1, 0)) %>%
mutate(is_2018 = ifelse(year == 2018, 1, 0)) %>%
mutate(is_2019 = ifelse(year == 2019, 1, 0))
us_fdi$year <- as.character(us_fdi$year)
us_fdi <- us_fdi %>%
filter(direction_label == "Inward", mode_label == "Flow", year %in% c("2017", "2018", "2019"))
us_fdi_for_join <- us_fdi %>% # Eliminating unnecessary columns
select(1, 3, 8:11)
world_trade_final <- world_trade_final %>%
inner_join(us_fdi_for_join, by = c("country_name" = "economy_label", "year" = "year"))
world_trade_final <- world_trade_final %>%
filter(country_name != "World")
world_trade_final <- world_trade_final %>%
mutate(ln_gdp = log(gdp), ln_gdp_per_cap_current = log(gdppercapcurrentusd), ln_gdp_per_cap2010 = log(gdppercap2010usd))
world_trade_final <- world_trade_final %>%
mutate(gdppercapcurrentusd_sq = gdppercapcurrentusd^2, gdppercap2010usd = gdppercap2010usd^2)
world_trade_final <- world_trade_final %>%
select(-c(17:18))
world_trade_final <- world_trade_final %>%
rename(value_of_inbound_fdi_mil_usd = us_dollars_at_current_prices_in_millions) %>%
rename(value_of_inbound_fdi_usd_per_cap = us_dollars_at_current_prices_per_capita)
world_trade_final <- world_trade_final %>%
filter(country_name != "Euro area" & country_name != "Sub-Saharan Africa")
world2 <- world
world2$name_long <- standardize.countrynames(world2$name_long, standard = "iso", suggest = "auto")
View(world_trade_final)
world_trade_mapping_17 <- world2 %>%
left_join(world_trade_final, by = c("name_long" = "country_name")) %>%
filter(year == "2017")
ggplot() +
geom_sf(data = world_trade_mapping_17, aes(fill = value_of_inbound_fdi_mil_usd)) +
scale_fill_viridis_c(option = "magma")
View(world_trade_final)
View(us_fdi_for_join)
View(us_fdi)
view(us_fdi) %>%
view(us_fdi) %>%
filter(economy_label == "Mauritania")
view(us_fdi) %>%
filter(economy_label = "Mauritania")
view(us_fdi) %>%
filter(economy_label = "Libya")
world_trade_mapping_18 <- world2 %>%
inner_join(world_trade_final, by = c("name_long" = "country_name")) %>%
filter(year == "2018")
world_trade_mapping_19 <- world2 %>%
inner_join(world_trade_final, by = c("name_long" = "country_name")) %>%
filter(year == "2019")
ggplot() +
geom_sf(data = world_trade_mapping_17, aes(fill = value_of_inbound_fdi_mil_usd)) +
scale_fill_viridis_c(option = "magma")
ggplot() +
geom_sf(data = world_trade_mapping_17, aes(fill = value_of_inbound_fdi_mil_usd)) +
scale_fill_viridis_c(option = "magma")
ggplot() +
geom_sf(data = world_trade_mapping_18, aes(fill = value_of_inbound_fdi_mil_usd)) +
scale_fill_viridis_c(option = "magma")
ggplot() +
geom_sf(data = world_trade_mapping_17, aes(fill = value_of_inbound_fdi_mil_usd)) +
scale_fill_viridis_c(option = "magma")
ggplot() +
geom_sf(data = world_trade_mapping_19, aes(fill = value_of_inbound_fdi_mil_usd)) +
scale_fill_viridis_c(option = "magma")
ggplot() +
geom_sf(data = world_trade_mapping_19, aes(fill = value_of_inbound_fdi_mil_usd)) +
scale_fill_viridis_c(option = "magma") +
theme(panel.grid.major = element_lin(color = gray(.5), linetype = "dashed", size = 0.5, panel.background = element_rect(fill = "aliceblue")))
ggplot() +
geom_sf(data = world_trade_mapping_19, aes(fill = value_of_inbound_fdi_mil_usd)) +
scale_fill_viridis_c(option = "magma") +
theme(panel.grid.major = element_line(color = gray(.5), linetype = "dashed", size = 0.5, panel.background = element_rect(fill = "aliceblue")))
View(world2)
world_points <- st_centroid(world2)
library(sf)
world_points <- st_centroid(world2)
world_points <- st_centroid(world_trade_mapping_19)
world_points <- cbind(world, st_coordinates(st_centroid(world_trade_mapping_19$geom)))
world_points <- cbind(world_trade_mapping_19, st_coordinates(st_centroid(world_trade_mapping_19$geom)))
ggplot(data = world_trade_mapping_19) +
geom_sf() +
geom_text(data = world_points, aes(x = X, y = Y, label = name),
color = "darkblue", fontface = "bold", check_overlap = FALSE)
View(world_trade_mapping_19)
ggplot(data = world_trade_mapping_19) +
geom_sf() +
geom_text(data = world_points, aes(x = X, y = Y, label = name_long),
color = "darkblue", fontface = "bold", check_overlap = FALSE)
ggplot(data = world_trade_mapping_19) +
geom_sf() +
geom_text(data = world_points, aes(x = X, y = Y, label = name_long, size = 4),
color = "darkblue", fontface = "bold", check_overlap = FALSE)
ggplot(data = world_trade_mapping_19) +
geom_sf() +
geom_text(data = world_points, aes(x = X, y = Y, label = name_long),
color = "darkblue", fontface = "bold", check_overlap = FALSE, size = 4)
ggplot(data = world_trade_mapping_19) +
geom_sf() +
geom_text(data = world_points, aes(x = X, y = Y, label = name_long),
color = "darkblue", fontface = "bold", check_overlap = FALSE, size = 1)
ggplot(data = world_trade_mapping_19) +
geom_sf() +
geom_text(data = world_points, aes(x = X, y = Y, label = name_long),
color = "darkblue", fontface = "bold", check_overlap = FALSE, size = 2)
ggplot() +
geom_sf(data = world_trade_mapping_17, aes(fill = value_of_inbound_fdi_mil_usd)) +
scale_fill_viridis_c(option = "magma")
ggplot() +
geom_sf(data = world_trade_mapping_17, aes(fill = value_of_inbound_fdi_mil_usd)) +
scale_fill_viridis_c(option = "magma") +
ggtitle("Inbound FDI in 2017")
ggplot() +
geom_sf(data = world_trade_mapping_17, aes(fill = value_of_inbound_fdi_mil_usd)) +
scale_fill_viridis_c(option = "magma") +
ggtitle("Inbound FDI in 2017") +
labs(fill = "Inbound FDI")
ggplot() +
geom_sf(data = world_trade_mapping_17, aes(fill = value_of_inbound_fdi_mil_usd)) +
scale_fill_viridis_c(option = "magma") +
ggtitle("Inbound FDI in 2017") +
labs(fill = "Inbound FDI (Million USD")
ggplot() +
geom_sf(data = world_trade_mapping_17, aes(fill = ln_gdp_per_cap_current)) +
scale_fill_viridis_c(option = "magma") +
ggtitle("Inbound FDI in 2017") +
labs(fill = "Inbound FDI (Million USD")
ggplot() +
geom_sf(data = world_trade_mapping_17, aes(fill = ln_gdp_per_cap_current)) +
scale_fill_viridis_c(option = "magma") +
ggtitle("Inbound FDI Per Capita in 2017") +
labs(fill = "Inbound FDI (Million USD")
